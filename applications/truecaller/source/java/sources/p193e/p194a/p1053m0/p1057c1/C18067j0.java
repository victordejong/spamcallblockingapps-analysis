package p193e.p194a.p1053m0.p1057c1;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import com.razorpay.AnalyticsConstants;
import p193e.p194a.p1053m0.p1054b1.AbstractC17917j;
import s1.z.c.f0;
import s1.z.c.l;
/* renamed from: e.a.m0.c1.j0 */
/* loaded from: classes8-dex2jar.jar:e/a/m0/c1/j0.class */
public final class C18067j0 implements AbstractC18063h0 {

    /* renamed from: a */
    public final AbstractC17917j f50987a;

    public C18067j0(C18065i0 c18065i0, AbstractC17917j abstractC17917j) {
        l.e(c18065i0, "threadStatsCalculator");
        l.e(abstractC17917j, "migrationHelperV72");
        this.f50987a = abstractC17917j;
    }

    @Override // p193e.p194a.p1053m0.p1057c1.AbstractC18063h0
    /* renamed from: a */
    public String[] mo15498a() {
        return new String[]{"\n    CREATE TABLE msg_thread_stats (\n    latest_message_id INTEGER,\n    latest_message_status INTEGER,\n    latest_message_media_count INTEGER DEFAULT(0),\n    latest_message_media_type TEXT,\n    unread_messages_count INTEGER DEFAULT(0),\n    latest_sim_token TEXT DEFAULT('-1'),\n    date_sorting INTEGER DEFAULT(0),\n    snippet_text TEXT DEFAULT(''),\n    is_rich_text_snippet INTEGER DEFAULT(0),\n    actions_dismissed INTEGER DEFAULT(0),\n    filter INTEGER NOT NULL,\n    latest_message_raw_status INTEGER DEFAULT(0),\n    latest_message_delivery_status INTEGER DEFAULT(0),\n    latest_message_read_status INTEGER DEFAULT(0),\n    latest_message_transport INTEGER DEFAULT(0),\n    conversation_id INTEGER NOT NULL REFERENCES msg_conversations (_id) ON DELETE CASCADE,\n    latest_message_sequence_number INTEGER NOT NULL DEFAULT(0),\n    marked_unread INTEGER NOT NULL DEFAULT(0),\n    pinned_date INTEGER NOT NULL DEFAULT(0),\n    archived_date INTEGER NOT NULL DEFAULT(0),\n    latest_message_date_sent INTEGER DEFAULT(0),\n    latest_message_history_type INTEGER DEFAULT(-1),\n    latest_message_history_action INTEGER DEFAULT(-1),\n    latest_message_history_filter_source TEXT,\n    latest_message_mentions TEXT,\n    history_events_count INTEGER DEFAULT(0),\n    UNIQUE(filter, conversation_id) ON CONFLICT REPLACE)\n", "CREATE INDEX idx_msg_thread_stats_latest_message_id ON msg_thread_stats (latest_message_id)"};
    }

    @Override // p193e.p194a.p1053m0.p1057c1.AbstractC18063h0
    /* renamed from: b */
    public void mo15497b(Context context, SQLiteDatabase sQLiteDatabase, int i, int i2) {
        l.e(context, AnalyticsConstants.CONTEXT);
        l.e(sQLiteDatabase, "db");
        if (i <= 72) {
            this.f50987a.mo15545b(sQLiteDatabase, i);
        }
        if (i <= 81) {
            sQLiteDatabase.execSQL("ALTER TABLE msg_thread_stats ADD COLUMN latest_message_raw_status INTEGER DEFAULT (0)");
            sQLiteDatabase.execSQL("ALTER TABLE msg_thread_stats ADD COLUMN latest_message_delivery_status INTEGER DEFAULT (0)");
            sQLiteDatabase.execSQL("ALTER TABLE msg_thread_stats ADD COLUMN latest_message_read_status INTEGER DEFAULT (0)");
            sQLiteDatabase.execSQL("ALTER TABLE msg_thread_stats ADD COLUMN latest_message_transport INTEGER DEFAULT (0)");
        }
    }

    @Override // p193e.p194a.p1053m0.p1057c1.AbstractC18063h0
    /* renamed from: c */
    public String[] mo15496c() {
        f0 f0Var = new f0(5);
        f0Var.a(new String[]{"\n            CREATE TRIGGER trigger_thread_stats_on_conversation_insert\n                AFTER INSERT\n                ON msg_conversations\n            BEGIN\n                INSERT OR IGNORE\n                    INTO msg_thread_stats (conversation_id, filter, history_events_count)\n                    VALUES (new._id, 1, new.history_events_count);\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_conversation_blacklist_count_update\n                AFTER UPDATE OF blacklist_count\n                ON msg_conversations\n                WHEN new.blacklist_count > 0\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET pinned_date = 0\n                    WHERE pinned_date != 0 \n                    AND conversation_id = new._id;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_history_events_count_conversation_update\n                AFTER UPDATE OF history_events_count\n                ON msg_conversations\n            BEGIN UPDATE msg_thread_stats\n                SET history_events_count = new.history_events_count\n                WHERE new._id = msg_thread_stats.conversation_id;\n            END\n        "});
        f0Var.a(new String[]{"\n            CREATE TRIGGER trigger_thread_stats_on_message_insert\n                AFTER INSERT\n                ON msg_messages\n            BEGIN\n                \n    INSERT OR IGNORE\n        INTO msg_thread_stats (conversation_id, filter)\n        VALUES (new.conversation_id, new.category);\n    UPDATE msg_thread_stats\n        SET latest_message_id = new._id\n        WHERE \n    (new.conversation_id = conversation_id\n    AND filter IN (new.category, 1) AND new.transport != 5)\n\n            AND (new.sequence_number > latest_message_sequence_number\n                OR new.sequence_number = latest_message_sequence_number\n                AND new.date >= date_sorting\n                OR latest_message_id IS NULL);\n    UPDATE msg_thread_stats\n        SET unread_messages_count = unread_messages_count + (NOT new.read AND new.status & 1 == 0 AND new.transport != 5)\n        WHERE \n    (new.conversation_id = conversation_id\n    AND filter IN (new.category, 1) AND new.transport != 5)\n;\n\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_message_category_update\n                AFTER UPDATE OF category, conversation_id\n                ON msg_messages\n            BEGIN\n                \n    INSERT OR IGNORE\n        INTO msg_thread_stats (conversation_id, filter)\n        VALUES (new.conversation_id, new.category);\n    UPDATE msg_thread_stats\n        SET latest_message_id = new._id\n        WHERE \n    (new.conversation_id = conversation_id\n    AND filter IN (new.category, 1) AND new.transport != 5)\n\n            AND (new.sequence_number > latest_message_sequence_number\n                OR new.sequence_number = latest_message_sequence_number\n                AND new.date >= date_sorting\n                OR latest_message_id IS NULL);\n    UPDATE msg_thread_stats\n        SET unread_messages_count = unread_messages_count + (NOT new.read AND new.status & 1 == 0 AND new.transport != 5)\n        WHERE \n    (new.conversation_id = conversation_id\n    AND filter IN (new.category, 1) AND new.transport != 5)\n;\n\n                \n    UPDATE msg_thread_stats\n        SET latest_message_id = \n    (SELECT _id\n        FROM msg_messages\n        WHERE transport != 5 AND msg_thread_stats.conversation_id = conversation_id\n            AND msg_thread_stats.filter IN (category, 1)\n        ORDER BY sequence_number DESC, date DESC, _id DESC\n        LIMIT 1)\n\n        WHERE latest_message_id = old._id;\n    UPDATE msg_thread_stats\n        SET unread_messages_count = unread_messages_count - (NOT old.read AND old.status & 1 == 0 AND old.transport != 5)\n        WHERE old.conversation_id = conversation_id\n            AND filter IN (old.category, 1);\n    DELETE\n        FROM msg_thread_stats\n        WHERE conversation_id = old.conversation_id AND latest_message_id IS NULL AND history_events_count < 1;\n\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_message_sequence_number_update\n                AFTER UPDATE OF sequence_number, date\n                ON msg_messages\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET latest_message_id = \n    (SELECT _id\n        FROM msg_messages\n        WHERE transport != 5 AND msg_thread_stats.conversation_id = conversation_id\n            AND msg_thread_stats.filter IN (category, 1)\n        ORDER BY sequence_number DESC, date DESC, _id DESC\n        LIMIT 1)\n\n                    WHERE \n    (new.conversation_id = conversation_id\n    AND filter IN (new.category, 1) AND new.transport != 5)\n;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_counts_on_message_update\n                AFTER UPDATE OF read, status\n                ON msg_messages\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET unread_messages_count = unread_messages_count - (NOT old.read AND old.status & 1 == 0 AND old.transport != 5) + (NOT new.read AND new.status & 1 == 0 AND new.transport != 5)\n                    WHERE \n    (new.conversation_id = conversation_id\n    AND filter IN (new.category, 1) AND new.transport != 5)\n;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_message_update\n                AFTER UPDATE OF status, date_sent\n                ON msg_messages\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET latest_message_status = new.status,\n                        latest_message_date_sent = new.date_sent\n                    WHERE new._id = latest_message_id;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_message_delete\n                AFTER DELETE\n                ON msg_messages\n            BEGIN\n                \n    UPDATE msg_thread_stats\n        SET latest_message_id = \n    (SELECT _id\n        FROM msg_messages\n        WHERE transport != 5 AND msg_thread_stats.conversation_id = conversation_id\n            AND msg_thread_stats.filter IN (category, 1)\n        ORDER BY sequence_number DESC, date DESC, _id DESC\n        LIMIT 1)\n\n        WHERE latest_message_id = old._id;\n    UPDATE msg_thread_stats\n        SET unread_messages_count = unread_messages_count - (NOT old.read AND old.status & 1 == 0 AND old.transport != 5)\n        WHERE old.conversation_id = conversation_id\n            AND filter IN (old.category, 1);\n    DELETE\n        FROM msg_thread_stats\n        WHERE conversation_id = old.conversation_id AND latest_message_id IS NULL AND history_events_count < 1;\n\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_mentions_update\n                AFTER UPDATE OF info11\n                ON msg_messages\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET latest_message_mentions = new.info11\n                    WHERE new._id = latest_message_id;\n            END\n        "});
        f0Var.a(new String[]{"\n            CREATE TRIGGER trigger_thread_stats_on_thread_stats_update\n                AFTER UPDATE OF latest_message_id\n                ON msg_thread_stats\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET date_sorting = (SELECT date\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id),\n                        latest_sim_token = (SELECT sim_token\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id),\n                        latest_message_status = (SELECT status\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id),\n                        snippet_text = (SELECT entity_info1\n                            FROM msg_entities\n                            WHERE message_id = new.latest_message_id\n                                AND type = 'text/plain'),\n                        is_rich_text_snippet = (SELECT entity_info2\n                            FROM msg_entities\n                            WHERE message_id = new.latest_message_id\n                                AND type = 'text/plain'),\n                        latest_message_media_count = (SELECT COUNT(*)\n                            FROM msg_entities\n                            WHERE message_id = new.latest_message_id\n                                AND type != 'text/plain'),\n                        latest_message_media_type = (SELECT type\n                            FROM msg_entities\n                            WHERE message_id = new.latest_message_id\n                                AND type != 'text/plain'\n                            LIMIT 1),\n                        latest_message_transport = (SELECT transport\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id),\n                        latest_message_raw_status = (SELECT IFNULL ((SELECT info2\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id AND transport = 0), 0)),\n                        latest_message_delivery_status = (SELECT IFNULL ((SELECT info1\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id AND transport = 2), 0)),\n                        latest_message_read_status = (SELECT IFNULL ((SELECT info2\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id AND transport = 2), 0)),\n                        latest_message_sequence_number = IFNULL((SELECT sequence_number\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id), 0),\n                        latest_message_date_sent = (SELECT date_sent\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id),\n                        latest_message_mentions = (SELECT info11\n                            FROM msg_messages\n                            WHERE _id = new.latest_message_id)\n                    WHERE conversation_id = new.conversation_id\n                        AND filter = new.filter;\n            END\n        ", "\n            CREATE TRIGGER trigger_threads_stats_on_new_msg_insert\n                AFTER UPDATE OF latest_message_id\n                ON msg_thread_stats\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET archived_date = 0\n                    WHERE conversation_id = new.conversation_id\n                        AND filter = new.filter;\n            END\n        ", "\n            CREATE TRIGGER trigger_threads_stats_on_history_events_count_change\n                AFTER UPDATE OF history_events_count\n                ON msg_thread_stats\n                WHEN new.history_events_count > old.history_events_count\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET archived_date = 0\n                    WHERE conversation_id = new.conversation_id\n                        AND filter = new.filter;\n            END\n        "});
        f0Var.a(new String[]{"\n            CREATE TRIGGER trigger_thread_stats_on_text_entity_insert\n                AFTER INSERT\n                ON msg_entities\n                WHEN new.type = 'text/plain'\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET snippet_text = new.entity_info1,\n                        is_rich_text_snippet = new.entity_info2\n                    WHERE latest_message_id = new.message_id;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_media_entity_insert\n                AFTER INSERT\n                ON msg_entities\n                WHEN new.type != 'text/plain'\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET latest_message_media_count = latest_message_media_count + 1,\n                        latest_message_media_type = new.type\n                    WHERE latest_message_id = new.message_id;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_media_entity_delete\n                AFTER DELETE\n                ON msg_entities\n                WHEN old.type != 'text/plain'\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET latest_message_media_count = latest_message_media_count - 1,\n                        latest_message_media_type = (SELECT type FROM msg_entities\n                        WHERE type != 'text/plain' LIMIT 1)\n                    WHERE latest_message_id = old.message_id;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_text_entity_delete\n                AFTER DELETE\n                ON msg_entities\n                WHEN old.type = 'text/plain'\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET snippet_text = NULL\n                    WHERE latest_message_id = old.message_id;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_mentions_text_update\n                AFTER UPDATE OF entity_info1\n                ON msg_entities\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET snippet_text = new.entity_info1\n                    WHERE new.message_id = latest_message_id AND new.type = 'text/plain';\n            END\n        "});
        f0Var.a(new String[]{"\n            CREATE TRIGGER trigger_thread_stats_on_im_receipt_update\n                AFTER UPDATE OF info1, info2\n                ON msg_messages\n                WHEN new.transport = 2\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET latest_message_delivery_status = new.info1,\n                        latest_message_read_status = new.info2,\n                        latest_message_transport = 2,\n                        latest_message_raw_status = 0\n                    WHERE latest_message_id = new._id;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_sms_report_update\n                AFTER UPDATE OF info2\n                ON msg_messages\n                WHEN new.transport = 0\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET latest_message_raw_status = new.info2,\n                        latest_message_transport = 0,\n                        latest_message_delivery_status = 0,\n                        latest_message_read_status = 0\n                    WHERE latest_message_id = new._id;\n            END\n        ", "\n            CREATE TRIGGER trigger_thread_stats_on_reactions_update\n                AFTER UPDATE OF info9\n                ON msg_messages\n                WHEN new.transport = 2\n            BEGIN\n                UPDATE msg_thread_stats\n                    SET archived_date = 0\n                    WHERE conversation_id = new.conversation_id;\n            END\n        "});
        return (String[]) f0Var.a.toArray(new String[f0Var.b()]);
    }
}
